<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="https://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="layouts/defaultTemplate">

	<head>
		<meta charset="UTF-8" />
		<title>My Products</title>
		<meta name="viewport" content="width=device-width,initial-scale=1" />
		<meta name="description" content=""/>
		

		<link rel="stylesheet" th:href="@{/css/styles.css}" />
		<script>
    		function confirmDelete(event) {
        		return confirm("Are you sure you want to delete this product?" + 
        				"This will delete the product permanently!");
    		}
		</script>
		
	</head>

	<body class="myproducts"> 
		<div layout:fragment="content">
			<div class="container" >
				<div class="container text-center" style="margin-left:100%;">
					<a href="products/createProduct" class="btn btn-warning" role="button">Post</a>
				</div>
				<div th:if="${products.empty}">
					<p style="text-align:center"> No product available </p>
				</div>
				<div class="card" style="width: 18rem;" th:each="product : ${products}" th:id="${product.id}" >
				
				<div th:id="'carousel-' + ${product.id}" class="carousel slide">
					<div class="carousel-inner">
						<div th:each="image, iterStat : ${product.images}" class="carousel-item" th:classappend="${iterStat.index == 0} ? 'active'">
							<img th:src="@{${image}}" class="d-block w-100" alt="Product Image">
						</div>
					  
					</div>
					<button class="carousel-control-prev" type="button" th:data-bs-target="'#carousel-' + ${product.id}" data-bs-slide="prev">
					  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
					  <span class="visually-hidden">Previous</span>
					</button>
					<button class="carousel-control-next" type="button" th:data-bs-target="'#carousel-' + ${product.id}" data-bs-slide="next">
					  <span class="carousel-control-next-icon" aria-hidden="true"></span>
					  <span class="visually-hidden">Next</span>
					</button>
				  </div>

					<div class="card-body">
						<h4 class="card-title" th:text="${product.name}">Name</h4> 
						<h5 class="card-title" th:text="${product.description}">Description</h5>
						<ul class="list-group list-group-flush">
							<li class="list-group-item"></li>
							<li class="list-group-item" th:text="'Year: ' + ${product.year}">Year</li>
							<li class="list-group-item" th:text="'Price: $' + ${product.price}">Price</li>
							<li class="list-group-item" th:text="'Seller: ' + ${product.createdBy}">Seller</li>
							<li th:if="${product.createdBy == user}" class="list-group-item"></li>
							<li class="list-group-item" th:text="'Phone: ' + ${product.phone}">phone</li>
 							<li class="list-group-item" th:text="'Email: ' + ${product.email}">Email</li>
 							<li class="list-group-item" th:text="'Other Contacts: ' + ${product.otherContacts}">Other Contacts</li>
						</ul>
						
						<form th:if="${product.createdBy == user}" th:action="@{'/products/deleteProduct/' + ${product.id}}" method="post" 
      style="display: flex; justify-content: space-around; width: 100%" 
      onsubmit="return confirmDelete(event)">
    <a th:href="@{/products/editProduct/{productId}(productId=${product.id})}" class="btn btn-warning" role="button">Edit</a>
    <button type="submit" class="btn btn-danger">Delete</button>
</form>
						
					</div>
				</div>
				
			</div>
			
		</div>		
	</body>
</html>